var size = 19;

var height = 10;
var width = 10;

//black = 1
//white = 2
var player1 = 1;
var player2 = 2;

var keyInput = "x";

var playercellX = size+2;
var playercellY = 1;

//player 1, player 2
var pointsPosY = [2, 3];
var pointsX = size+2;

function onOpen() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  ss.addMenu("Games", [{name: "New Go Game", functionName: "start"}]);
}

function start() {
  var ss = SpreadsheetApp.getActiveSheet();
  ss.getRange(1, 1, size, size).clear();
  
  for(var x = 1; x <= size; x++) {
    ss.setRowHeight(x, size);
  }

  for(var y = 1; y <= size; y++) {
    ss.setColumnWidth(y, size);
  }
  
  ss.getRange(1, 1, size, size).setBorder(true,true,true,true,true,true);
  ss.getRange(1, 1, size, size).setBackgroundColor(brown);
  ss.getRange(1, 1, size, size).setFontColor(brown);
  
  //ss.getRange(playercellX, playercellY-4, size, 5).setRowHeight(20);
  ss.getRange(playercellX, 1, size, pointsPosY[1]+1).setFontSize(14);
  ss.getRange(playercellX, 1, size, pointsPosY[1]+1).setFontWeight("bold");

  //ss.getRange(playercellX, playercellY-5).setValue("T");
  //ss.getRange(playercellX, playercellY-4).setValue("u");
  //ss.getRange(playercellX, playercellY-3).setValue("r");
  //ss.getRange(playercellX, playercellY-2).setValue("n");
 // ss.getRange(playercellX, playercellY-1).setValue(":");
  ss.getRange(playercellY, playercellX).setValue(player1);
  
  //ss.getRange(pointsY, pointsPosX[0]-3).setValue("P");
 // ss.getRange(pointsY, pointsPosX[0]-2).setValue("1");
 // ss.getRange(pointsY, pointsPosX[0]-1).setValue(":");
  ss.getRange(pointsPosY[0], pointsX).setValue("0");
 // ss.getRange(pointsY, pointsPosX[1]-3).setValue("P");
 // ss.getRange(pointsY, pointsPosX[1]-2).setValue("2");
 // ss.getRange(pointsY, pointsPosX[1]-1).setValue(":");
  ss.getRange(pointsPosY[1], pointsX).setValue("0");
  
  funkifizePlayer();
}

function addPoints(points, player) {
  var ss = SpreadsheetApp.getActiveSheet();
  var curPoints = ss.getRange(pointsPosY[player-1], pointsX).getValue();
  ss.getRange(pointsPosY[player-1], pointsX).setValue(curPoints+points);
}

function onEdit() {
  var ss = SpreadsheetApp.getActiveSheet();
  var cell = ss.getActiveCell();
  var turn = ss.getRange(playercellY, playercellX);
  
  if(inField(cell.getRow(), cell.getColumn())) {
    //yeah
    cell.setValue(turn.getValue());
    if(parseInt(turn.getValue()) == player1)
      turn.setValue(player2);
    else
      turn.setValue(player1);
    funkifizePlayer();
    checkStuff(cell.getRow(), cell.getColumn());
  } else if(inField(cell.getRow(), cell.getColumn())) {
    cell.clear();
  }
}

function clear() {
  SpreadsheetApp.getActiveSpreadheet().clear();
}

function isBlack(x, y) {
  var ss = SpreadsheetApp.getActiveSheet();
  return ss.getRange(x, y).getValue() == player1;
}

function isWhite(x, y) {
  var ss = SpreadsheetApp.getActiveSheet();
  return ss.getRange(x, y).getValue() == player2;
}

function isEmpty(x, y) {
  var ss = SpreadsheetApp.getActiveSheet();
  return ss.getRange(x,y).getValue() != player1 &&
    ss.getRange(x, y).getValue() != player2;
}
